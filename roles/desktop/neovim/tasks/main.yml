# vim: set foldmethod=marker nospell:
---
- name: Download neovim # {{{
  git:
    repo: https://github.com/neovim/neovim.git
    dest: ~/Development/OSS/neovim
    version: "{{ neovim.version }}"
# }}}
- name: Build neovim # {{{
  make:
    chdir: ~/Development/OSS/neovim
    params:
      CMAKE_BUILD_TYPE: Release
      "--jobs": "4"
# }}}
- name: Clone configs # {{{
  git:
    repo: git@github.com:jcmuller/myvimconfig.git
    dest: ~/Development/MyStuff/myvimconfig
    accept_hostkey: true
    update: true
# }}}
- name: link vim config # {{{
  file:
    src: ~/Development/MyStuff/myvimconfig/vim
    dest: ~/.vim
    state: link
# }}}
- name: Ensure ~/.config exists # {{{
  file:
    path: ~/.config/
    state: directory
# }}}
- name: symlink files # {{{
  file:
    src: ~/Development/MyStuff/myvimconfig/vim
    dest: ~/.config/nvim
    state: link
# }}}
- name: Install python libraries # {{{
  pip:
    name: pynvim
    executable: pip3
# }}}
- name: Install ruby libraries # {{{
  gem:
    name: neovim
    executable: ~/.rbenv/shims/gem
# }}}
- name: Install neovim # {{{
  become: true
  make:
    chdir: "/home/{{ user.name }}/Development/OSS/neovim"
    target: install
# }}}
- name: Remove vim # {{{
  become: true
  tags: [novim, neovim]
  apt:
    name:
      - vim
      - vim-nox
      - vim-tiny
    state: absent
# }}}
- name: Register neovim as a vim alternative # {{{
  become: true
  alternatives:
    name: vim
    path: /usr/local/bin/nvim
# }}}
- name: Install vimdiff # {{{
  tags: [vimdiff]
  become: true
  copy:
    src: vimdiff
    dest: /usr/local/bin/
    mode: 0755
# }}}
